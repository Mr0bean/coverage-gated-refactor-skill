# other_typescript_jest-testing

## 适用场景

- 其他模块（工具函数、适配层、脚本）及测试体系重构

## 重构思路

1. 测试先行：先补 contract/regression tests，再做结构调整。
2. 工具模块纯函数化：把可变状态与 I/O 隔离到边界层。
3. 小步提交：每次只处理一个模块或一个风险点。

## 合规思路

1. 测试数据合规：避免使用真实敏感数据作为夹具。
2. 日志与快照合规：输出内容脱敏，避免泄露密钥和身份信息。
3. 变更证据合规：保留覆盖率与回归结果用于审计追踪。

## 最佳实践

1. Jest 分层：单元测试覆盖工具逻辑，集成测试覆盖模块协作。
2. 覆盖率门禁：模块级 90%+（statements/lines）再进入重构。
3. 脆弱测试治理：减少对实现细节快照依赖，偏重行为断言。
4. 稳定执行：固定测试环境、时区与随机性。
