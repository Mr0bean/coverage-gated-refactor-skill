# backend_python_flask-microservice

## 适用场景

- `microservice/pdf-dealer/app.py` Flask 微服务重构

## 重构思路

1. 路由与处理逻辑拆分：`app.py` 保持入口，核心转换逻辑下沉到独立模块。
2. 统一请求与响应契约：明确输入二进制 PDF、输出 JSON 结构与错误字段。
3. 资源控制优先：为大文件处理加入超时、大小限制、异常兜底。

## 合规思路

1. 文件处理合规：限制文件大小、页数与处理时长，防止资源滥用。
2. 运行时安全：生产禁用 debug，异常返回不泄露内部堆栈。
3. 依赖合规：固定依赖版本并做漏洞扫描，避免高危包漂移。

## 最佳实践

1. Flask 路由薄化：`request` 解析和业务转换分离。
2. 错误处理标准化：统一返回 `success/error/code`。
3. 处理链可测：核心函数纯函数化，针对空文件/损坏文件/超大文件写测试。
4. 进程模型清晰：开发与生产启动方式区分（Flask dev server vs gunicorn）。
