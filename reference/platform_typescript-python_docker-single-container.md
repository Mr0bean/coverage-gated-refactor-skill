# platform_typescript-python_docker-single-container

## 适用场景

- Next.js + Python 微服务共容器部署（当前 `Dockerfile`）

## 重构思路

1. 明确进程边界：Node 与 Python 进程启动、存活、退出策略可观测。
2. 配置集中化：端口、服务地址、资源限制通过环境变量管理。
3. 构建分层优化：依赖层与源码层分离，提升缓存命中与发布效率。

## 合规思路

1. 供应链合规：基础镜像与依赖版本固定并定期扫描。
2. 运行时合规：最小权限运行、避免把敏感配置写进镜像。
3. 安全暴露面：仅暴露必要端口，限制调试能力进入生产。

## 最佳实践

1. 优先使用进程管理方案（supervisor/s6/sidecar编排）替代简单后台并行命令。
2. 健康检查覆盖双进程（Node、Python）并支持优雅关闭。
3. 构建产物最小化：移除无关文件，减小镜像体积。
4. 发布门禁：构建成功 + 健康检查 + 关键接口回归测试。
